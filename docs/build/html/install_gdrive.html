

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Install Google Drive &#8212; USP HPC 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="_static/favicon_1.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working with modules" href="custom_module.html" />
    <link rel="prev" title="Server configuration" href="server_config.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="custom_module.html" title="Working with modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="server_config.html" title="Server configuration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">USP HPC 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Install Google Drive</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="install-google-drive">
<h1>Install Google Drive<a class="headerlink" href="#install-google-drive" title="Permalink to this headline">¶</a></h1>
<p>Since data in the server are deleted periodically, keeping an external backup makes the recover easy. Storing in Google Drive is handy since the USP account has unlimited storage. This section shows how to access Google Drive in lince with <strong>gdrive</strong>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Anyone with access to <strong>gdrive</strong> may access your files in Google Drive. If you have sensitive information in your USP account, create another Google account just to store HPC backups.</p>
</div>
<p>According to the developer, gdrive is no longer maintained although it’s still possible to connect and sync folders with Google Drive.</p>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Create Google credentials</p></li>
<li><p>Download GDrive</p></li>
<li><p>Edit configuration</p></li>
<li><p>Code compilation</p></li>
<li><p>Access GDrive</p></li>
</ol>
<p>First you need to create a credential in Google to give permission for an application access GDrive. When you do this, you’ll receive an ID and a key. This step is done only once. Follow the instructions in this <a class="reference external" href="https://github.com/mbrother2/backuptogoogle/wiki/Create-own-Google-credential-step-by-step">site</a> .</p>
<div class="section" id="download-gdrive">
<h2>Download GDrive<a class="headerlink" href="#download-gdrive" title="Permalink to this headline">¶</a></h2>
<p>Run all Linux commands in the server. The GDrive code was written in <code class="docutils literal notranslate"><span class="pre">go</span></code> and may be downloaded from GitHub with this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ go get github.com/prasmussen/gdrive
</pre></div>
</div>
</div>
<div class="section" id="edit-configuration">
<h2>Edit configuration<a class="headerlink" href="#edit-configuration" title="Permalink to this headline">¶</a></h2>
<p>The code will be downloaded to the folder <code class="docutils literal notranslate"><span class="pre">~/go/src/github.com/prasmussen/gdrive</span></code>. Go to this folder, open the file <code class="docutils literal notranslate"><span class="pre">handlers_drive.go</span></code> with a text editor of your choice and update the following lines with the credentials you got from the previous step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">ClientId</span> <span class="o">=</span> <span class="s2">&quot;367116221053-7n0v**.apps.googleusercontent.com&quot;</span>
<span class="n">const</span> <span class="n">ClientSecret</span> <span class="o">=</span> <span class="s2">&quot;1qsNodXN*****jUjmvhoO&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="code-compilation">
<h2>Code compilation<a class="headerlink" href="#code-compilation" title="Permalink to this headline">¶</a></h2>
<p>Now, compile the code in this folder with the following command. No message should appear after running it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ go build
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gdrive</span></code> file is created in this folder. Change permission to make it executable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ chmod 755 gdrive
</pre></div>
</div>
</div>
<div class="section" id="access-gdrive">
<h2>Access GDrive<a class="headerlink" href="#access-gdrive" title="Permalink to this headline">¶</a></h2>
<p>Run the <code class="docutils literal notranslate"><span class="pre">gdrive</span> <span class="pre">list</span></code> command to start the authentication process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./gdrive list
Authentication needed
Go to the following url in your browser:
https://accounts.google.com/o/oauth2/auth?access_type=offl...
Enter verification code:
</pre></div>
</div>
<p>Copy and paste the link in your browser to allow access. After inserting the verification code, the root folder in your Google Drive is listed in terminal. Then, move the <code class="docutils literal notranslate"><span class="pre">gdrive</span></code> file to folder <code class="docutils literal notranslate"><span class="pre">~/.local/bin</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mkdir ~/.local/bin
$ mv ~/go/src/github.com/prasmussen/gdrive/gdrive ~/.local/bin
</pre></div>
</div>
<p>The complete list of options in <code class="docutils literal notranslate"><span class="pre">gdrive</span></code> is available at the developer’s <a class="reference external" href="https://github.com/prasmussen/gdrive">website</a> .</p>
</div>
<div class="section" id="folder-synchronization">
<h2>Folder synchronization<a class="headerlink" href="#folder-synchronization" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">gdrive</span></code> creates a <code class="docutils literal notranslate"><span class="pre">fileId</span></code> for each file and folder stored in drive. Use this <code class="docutils literal notranslate"><span class="pre">fileId</span></code> to sync a folder. In this example, the  <code class="docutils literal notranslate"><span class="pre">fileId</span></code> is <code class="docutils literal notranslate"><span class="pre">0B3X9GlR6EmbnOEd6cEh6bU9XZWM</span></code> and the folder <code class="docutils literal notranslate"><span class="pre">_release/bin</span></code> is being synced:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Create directory on drive
$ gdrive mkdir drive-bin
Directory 0B3X9GlR6EmbnOEd6cEh6bU9XZWM created

# Sync to drive
$ gdrive sync upload _release/bin 0B3X9GlR6EmbnOEd6cEh6bU9XZWM
Starting sync...
Collecting local and remote file information...
Found 32 local files and 0 remote files

6 remote directories are missing
[0001/0006] Creating directory drive-bin/bsd
[0002/0006] Creating directory drive-bin/linux
[0003/0006] Creating directory drive-bin/osx
[0004/0006] Creating directory drive-bin/plan9
[0005/0006] Creating directory drive-bin/solaris
[0006/0006] Creating directory drive-bin/windows

26 remote files are missing
[0001/0026] Uploading bsd/gdrive-dragonfly-x64 -&gt; drive-bin/bsd/gdrive-dragonfly-x64
[0002/0026] Uploading bsd/gdrive-freebsd-386 -&gt; drive-bin/bsd/gdrive-freebsd-386
[0003/0026] Uploading bsd/gdrive-freebsd-arm -&gt; drive-bin/bsd/gdrive-freebsd-arm
[0004/0026] Uploading bsd/gdrive-freebsd-x64 -&gt; drive-bin/bsd/gdrive-freebsd-x64
[0005/0026] Uploading bsd/gdrive-netbsd-386 -&gt; drive-bin/bsd/gdrive-netbsd-386
[0006/0026] Uploading bsd/gdrive-netbsd-arm -&gt; drive-bin/bsd/gdrive-netbsd-arm
[0007/0026] Uploading bsd/gdrive-netbsd-x64 -&gt; drive-bin/bsd/gdrive-netbsd-x64
[0008/0026] Uploading bsd/gdrive-openbsd-386 -&gt; drive-bin/bsd/gdrive-openbsd-386
[0009/0026] Uploading bsd/gdrive-openbsd-arm -&gt; drive-bin/bsd/gdrive-openbsd-arm
[0010/0026] Uploading bsd/gdrive-openbsd-x64 -&gt; drive-bin/bsd/gdrive-openbsd-x64
[0011/0026] Uploading linux/gdrive-linux-386 -&gt; drive-bin/linux/gdrive-linux-386
[0012/0026] Uploading linux/gdrive-linux-arm -&gt; drive-bin/linux/gdrive-linux-arm
[0013/0026] Uploading linux/gdrive-linux-arm64 -&gt; drive-bin/linux/gdrive-linux-arm64
[0014/0026] Uploading linux/gdrive-linux-mips64 -&gt; drive-bin/linux/gdrive-linux-mips64
[0015/0026] Uploading linux/gdrive-linux-mips64le -&gt; drive-bin/linux/gdrive-linux-mips64le
[0016/0026] Uploading linux/gdrive-linux-ppc64 -&gt; drive-bin/linux/gdrive-linux-ppc64
[0017/0026] Uploading linux/gdrive-linux-ppc64le -&gt; drive-bin/linux/gdrive-linux-ppc64le
[0018/0026] Uploading linux/gdrive-linux-x64 -&gt; drive-bin/linux/gdrive-linux-x64
[0019/0026] Uploading osx/gdrive-osx-386 -&gt; drive-bin/osx/gdrive-osx-386
[0020/0026] Uploading osx/gdrive-osx-arm -&gt; drive-bin/osx/gdrive-osx-arm
[0021/0026] Uploading osx/gdrive-osx-x64 -&gt; drive-bin/osx/gdrive-osx-x64
[0022/0026] Uploading plan9/gdrive-plan9-386 -&gt; drive-bin/plan9/gdrive-plan9-386
[0023/0026] Uploading plan9/gdrive-plan9-x64 -&gt; drive-bin/plan9/gdrive-plan9-x64
[0024/0026] Uploading solaris/gdrive-solaris-x64 -&gt; drive-bin/solaris/gdrive-solaris-x64
[0025/0026] Uploading windows/gdrive-windows-386.exe -&gt; drive-bin/windows/gdrive-windows-386.exe
[0026/0026] Uploading windows/gdrive-windows-x64.exe -&gt; drive-bin/windows/gdrive-windows-x64.exe
Sync finished in 1m18.891946279s

# Add new local file
$ echo &quot;google drive binaries&quot; &gt; _release/bin/readme.txt

# Sync again
$ gdrive sync upload _release/bin 0B3X9GlR6EmbnOEd6cEh6bU9XZWM
Starting sync...
Collecting local and remote file information...
Found 33 local files and 32 remote files

1 remote files are missing
[0001/0001] Uploading readme.txt -&gt; drive-bin/readme.txt
Sync finished in 2.201339535s

# Modify local file
$ echo &quot;for all platforms&quot; &gt;&gt; _release/bin/readme.txt

# Sync again
$ gdrive sync upload _release/bin 0B3X9GlR6EmbnOEd6cEh6bU9XZWM
Starting sync...
Collecting local and remote file information...
Found 33 local files and 33 remote files

1 local files has changed
[0001/0001] Updating readme.txt -&gt; drive-bin/readme.txt
Sync finished in 1.890244258s
</pre></div>
</div>
</div>
<div class="section" id="list-of-options">
<h2>List of options<a class="headerlink" href="#list-of-options" title="Permalink to this headline">¶</a></h2>
<p>Use the command <code class="docutils literal notranslate"><span class="pre">gdrive</span> <span class="pre">help</span></code> to list the available options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ gdrive help
gdrive usage:

gdrive [global] list [options]                                 List files
gdrive [global] download [options] &lt;fileId&gt;                    Download file or directory
gdrive [global] download query [options] &lt;query&gt;               Download all files and directories matching query
gdrive [global] upload [options] &lt;path&gt;                        Upload file or directory
gdrive [global] upload - [options] &lt;name&gt;                      Upload file from stdin
gdrive [global] update [options] &lt;fileId&gt; &lt;path&gt;               Update file, this creates a new revision of the file
gdrive [global] info [options] &lt;fileId&gt;                        Show file info
gdrive [global] mkdir [options] &lt;name&gt;                         Create directory
gdrive [global] share [options] &lt;fileId&gt;                       Share file or directory
gdrive [global] share list &lt;fileId&gt;                            List files permissions
gdrive [global] share revoke &lt;fileId&gt; &lt;permissionId&gt;           Revoke permission
gdrive [global] delete [options] &lt;fileId&gt;                      Delete file or directory
gdrive [global] sync list [options]                            List all syncable directories on drive
gdrive [global] sync content [options] &lt;fileId&gt;                List content of syncable directory
gdrive [global] sync download [options] &lt;fileId&gt; &lt;path&gt;        Sync drive directory to local directory
gdrive [global] sync upload [options] &lt;path&gt; &lt;fileId&gt;          Sync local directory to drive
gdrive [global] changes [options]                              List file changes
gdrive [global] revision list [options] &lt;fileId&gt;               List file revisions
gdrive [global] revision download [options] &lt;fileId&gt; &lt;revId&gt;   Download revision
gdrive [global] revision delete &lt;fileId&gt; &lt;revId&gt;               Delete file revision
gdrive [global] import [options] &lt;path&gt;                        Upload and convert file to a google document, see &#39;about import&#39; for available conversions
gdrive [global] export [options] &lt;fileId&gt;                      Export a google document
gdrive [global] about [options]                                Google drive metadata, quota usage
gdrive [global] about import                                   Show supported import formats
gdrive [global] about export                                   Show supported export formats
gdrive version                                                 Print application version
gdrive help                                                    Print help
gdrive help &lt;command&gt;                                          Print command help
gdrive help &lt;command&gt; &lt;subcommand&gt;                             Print subcommand help
</pre></div>
</div>
</div>
<div class="section" id="schedule-daily-backup">
<h2>Schedule daily backup<a class="headerlink" href="#schedule-daily-backup" title="Permalink to this headline">¶</a></h2>
<p>Schedule daily backup of your folder with <code class="docutils literal notranslate"><span class="pre">crontab</span></code>. Use this template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ crontab -e
# Crontab - Crontab template to automate virtual world
# Template from https://gist.github.com/bretonics/9a48a3b9ef32d93d15f45c3f007550b4
# Andrés Bretón ~ http://andresbreton.com, dev@andresbreton.com
#
# ==============================================================================
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |   + command
# *  *  *  *  *  CMD
# ==============================================================================
#
# Set Path
PATH=/bin:/usr/bin:/usr/local/bin:/scratch/11568881
#
# Backup of work folder daily at 02:00 AM
# (change NUSP, folder name and fileId)
00 02 * * *   /scratch/&lt;Seu NUSP&gt;/.local/bin/gdrive sync upload _release/bin 0B3X9GlR6EmbnOEd6cEh6bU9XZWM   &gt;   backup.log  2&gt;&amp;1
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Install Google Drive</a><ul>
<li><a class="reference internal" href="#download-gdrive">Download GDrive</a></li>
<li><a class="reference internal" href="#edit-configuration">Edit configuration</a></li>
<li><a class="reference internal" href="#code-compilation">Code compilation</a></li>
<li><a class="reference internal" href="#access-gdrive">Access GDrive</a></li>
<li><a class="reference internal" href="#folder-synchronization">Folder synchronization</a></li>
<li><a class="reference internal" href="#list-of-options">List of options</a></li>
<li><a class="reference internal" href="#schedule-daily-backup">Schedule daily backup</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="server_config.html"
                        title="previous chapter">Server configuration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="custom_module.html"
                        title="next chapter">Working with modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/install_gdrive.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="custom_module.html" title="Working with modules"
             >next</a> |</li>
        <li class="right" >
          <a href="server_config.html" title="Server configuration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">USP HPC 0.0.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Install Google Drive</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Victor Ivamoto.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  </body>
</html>